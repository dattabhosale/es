<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LeapReplica - Electric Vehicles</title>
  <link rel="stylesheet" href="css/style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="/" class="brand">LeapReplica</a>
      <nav class="site-nav" id="site-nav">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>
      <button class="nav-toggle" id="nav-toggle" aria-label="Toggle navigation">☰</button>
    </div>
  </header>
  <main>
    <section class="hero">
      <div class="container hero-inner">
        <div class="hero-copy">
          <h1>Electric mobility, designed for the future.</h1>
          <p>Explore a new generation of electric vehicles with long range, smart features, and bold design.</p>
          <p><a class="btn" href="products.html">View Models</a></p>
        </div>
        <div class="hero-media">
          <img src="assets/car-hero.jpg" alt="Electric car mockup">
        </div>
      </div>
    </section>
    <section class="highlights">
      <div class="container">
        <h2>Featured Models</h2>
        <div class="cards">
          <article class="card">
            <img src="assets/model-a.jpg" alt="Model A">
            <h3>Model A</h3>
            <p>Long range, fast charging, advanced driver assistance.</p>
            <p><a class="link" href="products.html">Learn more</a></p>
          </article>
          <article class="card">
            <img src="assets/model-b.jpg" alt="Model B">
            <h3>Model B</h3>
            <p>Urban performance with compact design and premium interior.</p>
            <p><a class="link" href="products.html">Learn more</a></p>
          </article>
          <article class="card">
            <img src="assets/model-c.jpg" alt="Model C">
            <h3>Model C</h3>
            <p>An intelligent SUV with family-friendly range and space.</p>
            <p><a class="link" href="products.html">Learn more</a></p>
          </article>
        </div>
      </div>
    </section>
    <section class="about-teaser">
      <div class="container">
        <h2>Our Vision</h2>
        <p>We build electric vehicles that are safe, sustainable and delightful to drive. Technology and design come
          together to make mobility more efficient and enjoyable.</p>
        <p><a class="btn ghost" href="about.html">Learn about us</a></p>
      </div>
    </section>
  </main>
  <footer class="site-footer">
    <div class="container">
      <div>© 2025 LeapReplica</div>
      <nav class="foot-nav">
        <a href="privacy.html">Privacy</a>
        <a href="contact.html">Contact</a>
      </nav>
    </div>
  </footer>
  <!-- Salesforce Embedded Messaging Script -->
  <script type="text/javascript">
    function initEmbeddedMessaging() {
      try {
        embeddedservice_bootstrap.settings.language = "es"; // For example, enter 'en' or 'en-US'
        // Personalizzazione del pulsante
        window.addEventListener("onEmbeddedMessagingReady", () => {
          embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
            Country: "Spain",
            Language: "es",
            CountryCode: "es",
          });
        });
        embeddedservice_bootstrap.init(
          "00DMA000003XnGM",
          "LPM_Leapmotor",
          "https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231",
          {
            scrt2URL: "https://leapmotor--dev01.sandbox.my.salesforce-scrt.com",
          }
        );
      } catch (err) {
        console.error("Error loading Embedded Messaging: ", err);
      }
    }
	 (function () {
	let chatOpened = false;
	let nudge = null;
	let firstTimer = null;
	let followupTimer = null;
	let audioUnlocked = false;
 
	console.log("[DEBUG] Script nudge caricato");
 
	/* ===== Sblocca audio al primo click ===== */
	function unlockAudio() {
		if (!audioUnlocked) {
			const ctx = new (window.AudioContext || window.webkitAudioContext)();
			ctx.resume();
			audioUnlocked = true;
			console.log("[DEBUG] Audio sbloccato");
			document.removeEventListener("click", unlockAudio);
		}
	}
	document.addEventListener("click", unlockAudio);
 
	/* ===== Beep standard browser ===== */
	function playBeep(frequency = 440, duration = 200) {
		console.log("[DEBUG] playBeep chiamato, audioUnlocked=", audioUnlocked);
		if (!audioUnlocked) return;
		try {
			const ctx = new (window.AudioContext || window.webkitAudioContext)();
			const oscillator = ctx.createOscillator();
			const gainNode = ctx.createGain();
			oscillator.connect(gainNode);
			gainNode.connect(ctx.destination);
			oscillator.type = "sine";
			oscillator.frequency.value = frequency;
			gainNode.gain.setValueAtTime(0.1, ctx.currentTime);
			oscillator.start();
			oscillator.stop(ctx.currentTime + duration / 1000);
			console.log("[DEBUG] beep riprodotto");
		} catch (e) {
			console.warn("[DEBUG] Beep non supportato dal browser", e);
		}
	}
 
	/* ===== Mostra Nudge ===== */
	function showNudge(message) {
		console.log("[DEBUG] showNudge chiamato con messaggio:", message);
		if (nudge) {
			console.log("[DEBUG] nudge già presente, non creo nuovo");
			return;
		}
 
		playBeep();
 
		nudge = document.createElement("div");
		nudge.className = "chat-nudge";
		nudge.textContent = message;
 
		// Bottone X
		const closeBtn = document.createElement("span");
		closeBtn.className = "close-btn";
		closeBtn.textContent = "×";
		closeBtn.addEventListener("click", function(e) {
			e.stopPropagation();
			console.log("[DEBUG] Nudge chiuso con X");
			removeNudge();
		});
		nudge.appendChild(closeBtn);
 
		// Click sul nudge apre chat
		nudge.addEventListener("click", function () {
			console.log("[DEBUG] Nudge cliccato, apro chat");
			if (embeddedservice_bootstrap && embeddedservice_bootstrap.open) {
				embeddedservice_bootstrap.open();
			} else {
				console.warn("[DEBUG] embeddedservice_bootstrap.open non disponibile");
			}
			removeNudge();
		});
 
		document.body.appendChild(nudge);
		console.log("[DEBUG] Nudge aggiunto al DOM");
	}
 
	function removeNudge() {
		if (nudge) {
			nudge.remove();
			console.log("[DEBUG] Nudge rimosso");
			nudge = null;
		}
	}
 
	/* ===== Eventi Embedded Messaging ===== */
	window.addEventListener("onEmbeddedMessagingConversationOpened", function () {
		console.log("[DEBUG] Chat aperta");
		chatOpened = true;
		removeNudge();
		if (firstTimer) {
			clearTimeout(firstTimer);
			console.log("[DEBUG] Primo timer cancellato");
		}
		if (followupTimer) {
			clearTimeout(followupTimer);
			console.log("[DEBUG] Followup timer cancellato");
		}
	});
 
	window.addEventListener("onEmbeddedMessagingConversationClosed", function () {
		console.log("[DEBUG] Chat chiusa");
		chatOpened = false;
		removeNudge();
 
		if (followupTimer) clearTimeout(followupTimer);
		followupTimer = setTimeout(function () {
			console.log("[DEBUG] Followup timer scaduto, chatOpened=", chatOpened);
			if (!chatOpened) {
				showNudge("Sigue hablándome.");
			}
		}, 30000);
	});
 
	window.addEventListener("onEmbeddedMessagingReady", function () {
		console.log("[DEBUG] onEmbeddedMessagingReady");
		if (firstTimer) clearTimeout(firstTimer);
		firstTimer = setTimeout(function () {
			console.log("[DEBUG] Primo timer scaduto, chatOpened=", chatOpened);
			if (!chatOpened) {
				showNudge("¡Habla conmigo!");
			}
		}, 30000);
	});
})();
  </script>
  <!-- Custom Styles for Embedded Messaging Chat -->
<style>
/* ===== Chat embedded ===== */
.embeddedMessagingFrame {
	transform: translateY(-80px) !important; /* solleva chat desktop */
	border-radius: 16px !important;
	overflow: hidden !important;
}
 
.embeddedMessagingHeader {
	border-top-left-radius: 16px !important;
	border-top-right-radius: 16px !important;
}
 
.embeddedMessagingConversation {
	border-bottom-left-radius: 16px !important;
	border-bottom-right-radius: 16px !important;
}
 
/* ===== Pulsante chat fisso ===== */
.embeddedServiceLauncher,
.embeddedServiceSidebarButton {
	position: fixed !important;
	bottom: 30px !important;
	right: 30px !important;
	z-index: 9999 !important;
}
 
@media (max-width: 1024px) {
	.embeddedMessagingFrame {
		transform: translateY(0) !important;
		border-radius: 0 !important;
	}
	.embeddedMessagingHeader,
	.embeddedMessagingConversation {
		border-radius: 0 !important;
	}
	.embeddedServiceLauncher,
	.embeddedServiceSidebarButton {
		bottom: 20px !important;
		right: 20px !important;
	}
}
 
/* ===== Nudge messaggio ===== */
.chat-nudge {
	position: fixed;
	bottom: 110px;
	right: 30px;
	background: #ffffff;
	color: #000;
	padding: 10px 14px 10px 12px; /* spazio per X */
	border-radius: 12px;
	box-shadow: 0 6px 20px rgba(0,0,0,0.15);
	font-size: 14px;
	font-weight: 500;
	z-index: 9999;
	cursor: pointer;
	animation: bounce 5s ease-out; /* animazione 5s */
}
 
/* Animazione bounce */
@keyframes bounce {
	0%, 100% { transform: translateY(0); }
	25% { transform: translateY(-6px); }
	50% { transform: translateY(0); }
	75% { transform: translateY(-3px); }
}
 
/* Bottone X */
.chat-nudge .close-btn {
	position: absolute;
	top: 4px;
	right: 6px;
	font-weight: bold;
	font-size: 14px;
	color: #666;
	cursor: pointer;
	user-select: none;
}
 
.chat-nudge .close-btn:hover {
	color: #000;
}
 
@media (max-width: 1024px) {
	.chat-nudge {
		bottom: 90px;
		right: 20px;
		font-size: 13px;
	}
}
</style>

  <!-- Load Salesforce Embedded Messaging Bootstrap -->
  <script
    type="text/javascript"
    src="https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231/assets/js/bootstrap.min.js"
    onload="initEmbeddedMessaging()"
  ></script>
</body>
</html>
