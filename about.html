<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>About - LeapReplica</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">LeapReplica</a>
      <nav class="site-nav">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>
      <button class="nav-toggle" aria-label="Toggle navigation">☰</button>
    </div>
  </header>

  <main>
    <section class="container">
      <h1>About LeapReplica</h1>
      <p>LeapReplica is a fictional electric vehicle company created for demonstration purposes. We focus on sustainable mobility, safety and smart vehicle software.</p>
      <h2>Mission</h2>
      <p>To accelerate the transition to sustainable transportation through thoughtful design and engineering.</p>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">© 2025 LeapReplica</div>
  </footer>

  <script src="js/main.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap');
</style>

<script type='text/javascript'>
    /**
     * Initialize Salesforce Embedded Messaging
     */
    function initEmbeddedMessaging() {
        try {
            const countryCode = getCountryCodeFromPath();
            const countryInfo = getCountryInfo(countryCode);

            // Configure settings
            embeddedservice_bootstrap.settings.language = countryInfo.language;
            embeddedservice_bootstrap.settings.shouldOpenLinksInSameTab = true;
            embeddedservice_bootstrap.settings.hideChatButtonOnLoad = true;

            // Set prechat fields
            window.addEventListener("onEmbeddedMessagingReady", function() {
                embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
                    Country: countryInfo.name,
                    Language: countryInfo.language,
                    CountryCode: countryInfo.code,
                });
            });

            // Initialize
            embeddedservice_bootstrap.init(
                "00DMA000003XnGM",
                "LPM_Leapmotor",
                "https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231", {
                    scrt2URL: "https://leapmotor--dev01.sandbox.my.salesforce-scrt.com",
                }
            );
        } catch (err) {
            console.error("Error loading Embedded Messaging:", err);
        }
    }

    /* --- Helper Functions for Country Logic --- */
    function getCountryCodeFromPath() {
        const pathParts = window.location.pathname.split('/').filter(p => p.length > 0);
        return pathParts.length > 0 ? pathParts[0].toLowerCase() : 'en';
    }

    function getCountryInfo(countryCode) {
        const MAPPING = {
            'it': { name: 'Italy', language: 'it', code: 'it' },
            'es': { name: 'Spain', language: 'es', code: 'es' },
            'fr': { name: 'France', language: 'fr', code: 'fr' },
            'de': { name: 'Germany', language: 'de', code: 'de' },
            'uk': { name: 'United Kingdom', language: 'en_US', code: 'uk' },
            'us': { name: 'United States', language: 'en_US', code: 'us' },
            'en': { name: 'United States', language: 'en_US', code: 'en' }
        };
        return MAPPING[countryCode] || MAPPING['en'];
    }

    /**
     * Custom Chat Button Module
     * Implements PDF Design: Circular Button + Idle Proactive Message
     */
    (function() {
        'use strict';

        const CONFIG = {
            ids: {
                BUTTON: 'leap-chat-btn',
                BUBBLE: 'leap-chat-bubble',
                BADGE: 'leap-chat-badge',
                STYLES: 'leap-chat-css'
            },
            colors: {
                primary: '#009100', // Approx for Pantone 2427C / R0 G145 B0
                white: '#ffffff',
                text: '#333333'
            },
            timing: {
                idleThreshold: 5000 // 5 seconds (ADV 1 in PDF)
            }
        };

        [cite_start]// Localization for the "Proactive" bubble [cite: 14]
        const MESSAGES = {
            'es': '¿Necesitas ayuda?',
            'it': 'Hai bisogno di aiuto?',
            'fr': 'Besoin d\'aide ?',
            'de': 'Brauchen Sie Hilfe?',
            'en': 'Do you need help?'
        };

        let state = {
            idleTimer: null,
            countryCode: getCountryCodeFromPath(),
            esInstance: null
        };

        // --- Styles Injection ---
        function injectStyles() {
            if (document.getElementById(CONFIG.ids.STYLES)) return;
            const style = document.createElement('style');
            style.id = CONFIG.ids.STYLES;
            style.textContent = `
                #${CONFIG.ids.BUTTON} {
                    position: fixed;
                    right: 25px;
                    bottom: 25px;
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    background-color: ${CONFIG.colors.primary};
                    border: none;
                    cursor: pointer;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
                    z-index: 99999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }
                #${CONFIG.ids.BUTTON}:hover {
                    transform: scale(1.1);
                }
                /* Chat Icon SVG */
                .leap-icon {
                    width: 32px;
                    height: 32px;
                    fill: ${CONFIG.colors.white};
                }
                
                /* Proactive Bubble (ADV 1) */
                #${CONFIG.ids.BUBBLE} {
                    position: fixed;
                    right: 95px; /* Left of the button */
                    bottom: 35px;
                    background: ${CONFIG.colors.white};
                    color: ${CONFIG.colors.text};
                    padding: 12px 20px;
                    border-radius: 20px 20px 0 20px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
                    font-family: 'Montserrat', sans-serif; [cite_start]/* [cite: 18] */
                    font-weight: 600;
                    font-size: 14px;
                    opacity: 0;
                    transform: translateY(10px) scale(0.9);
                    transition: all 0.4s ease;
                    pointer-events: none;
                    z-index: 99998;
                    white-space: nowrap;
                }
                #${CONFIG.ids.BUBBLE}.visible {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                    pointer-events: auto;
                }
                
                /* Notification Badge (ADV 2) */
                #${CONFIG.ids.BADGE} {
                    position: absolute;
                    top: -2px;
                    right: -2px;
                    background-color: #ff3b30;
                    color: white;
                    font-family: 'Montserrat', sans-serif;
                    font-size: 11px;
                    font-weight: bold;
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border: 2px solid white;
                    display: none; /* Hidden by default */
                }
            `;
            document.head.appendChild(style);
        }

        // --- Logic: Idle Timer (ADV 1) ---
        function resetIdleTimer() {
            const bubble = document.getElementById(CONFIG.ids.BUBBLE);
            if (bubble && bubble.classList.contains('visible')) {
                // Optional: Hide bubble when user moves again? 
                // Based on PDF "When you dont move... you are on a specific page"
                // Usually we keep it open until clicked or dismissed, but let's hide it on interaction
                // bubble.classList.remove('visible'); 
            }

            clearTimeout(state.idleTimer);
            state.idleTimer = setTimeout(() => {
                showProactiveMessage();
            }, CONFIG.timing.idleThreshold);
        }

        function showProactiveMessage() {
            const bubble = document.getElementById(CONFIG.ids.BUBBLE);
            if (bubble && document.getElementById(CONFIG.ids.BUTTON).style.display !== 'none') {
                bubble.classList.add('visible');
                // Play Sound logic would go here (Browsers often block auto-audio without interaction)
                // const audio = new Audio('path/to/notification.mp3');
                // audio.play().catch(e => console.log('Audio blocked'));
            }
        }

        // --- DOM Elements ---
        function createElements() {
            // 1. Main Button
            const btn = document.createElement('button');
            btn.id = CONFIG.ids.BUTTON;
            btn.innerHTML = `
                <svg class="leap-icon" viewBox="0 0 24 24">
                   <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                </svg>
                <div id="${CONFIG.ids.BADGE}">1</div>
            `;
            
            // 2. Proactive Bubble
            const bubble = document.createElement('div');
            bubble.id = CONFIG.ids.BUBBLE;
            // Get localized text or default to English
            bubble.textContent = MESSAGES[state.countryCode] || MESSAGES['en'];
            
            // Append
            document.body.appendChild(btn);
            document.body.appendChild(bubble);

            // Events
            btn.onclick = function() {
                // Hide bubble on click
                bubble.classList.remove('visible'); 
                // Launch Chat
                if (state.esInstance && state.esInstance.utilAPI) {
                    state.esInstance.utilAPI.launchChat();
                }
            };
            
            // Initialize Idle Listeners
            document.addEventListener('mousemove', resetIdleTimer);
            document.addEventListener('keypress', resetIdleTimer);
            document.addEventListener('scroll', resetIdleTimer);
            resetIdleTimer(); // Start immediately
        }

        // --- Salesforce Integration ---
        function hideStandardButton(es) {
            if (es && es.utilAPI && es.utilAPI.hideChatButton) {
                es.utilAPI.hideChatButton();
            }
        }

        function init() {
            // Wait for Embedded Service
            const checkInterval = setInterval(() => {
                const es = window.embeddedservice_bootstrap;
                if (es && es.utilAPI) {
                    clearInterval(checkInterval);
                    state.esInstance = es;
                    injectStyles();
                    createElements();
                    hideStandardButton(es);

                    // Handle Window Events
                    window.addEventListener('onEmbeddedMessagingWindowMaximized', () => {
                        document.getElementById(CONFIG.ids.BUTTON).style.display = 'none';
                        document.getElementById(CONFIG.ids.BUBBLE).classList.remove('visible');
                    });

                    window.addEventListener('onEmbeddedMessagingWindowMinimized', () => {
                        document.getElementById(CONFIG.ids.BUTTON).style.display = 'flex';
                        // Example: Show badge when minimized (ADV 2)
                        // In a real scenario, you'd check for unread messages event
                        // document.getElementById(CONFIG.ids.BADGE).style.display = 'flex'; 
                    });
                }
            }, 200);
        }

        init();
    })();
</script>

<script type="text/javascript" 
    src="https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231/assets/js/bootstrap.min.js" 
    onload="initEmbeddedMessaging()">
</script>
</body>
</html>
