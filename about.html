<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>About - LeapReplica</title>
  <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">LeapReplica</a>
      <nav class="site-nav">
        <a href="index.html">Home</a>
        <a href="products.html">Products</a>
        <a href="about.html">About</a>
        <a href="contact.html">Contact</a>
      </nav>
      <button class="nav-toggle" aria-label="Toggle navigation">☰</button>
    </div>
  </header>

  <main>
    <section class="container">
      <h1>About LeapReplica</h1>
      <p>LeapReplica is a fictional electric vehicle company created for demonstration purposes. We focus on sustainable mobility, safety and smart vehicle software.</p>
      <h2>Mission</h2>
      <p>To accelerate the transition to sustainable transportation through thoughtful design and engineering.</p>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container">© 2025 LeapReplica</div>
  </footer>

  <script src="js/main.js"></script>
  <script type='text/javascript'>
    /**
     * Initialize Salesforce Embedded Messaging
     */
    function initEmbeddedMessaging() {
        try {
            const countryCode = getCountryCodeFromPath();
            const countryInfo = getCountryInfo(countryCode);
            // Configure settings
            embeddedservice_bootstrap.settings.language = countryInfo.language;
            embeddedservice_bootstrap.settings.shouldOpenLinksInSameTab = true;
            embeddedservice_bootstrap.settings.hideChatButtonOnLoad = true;
            // Set prechat fields
            embeddedservice_bootstrap.prechatAPI.setHiddenPrechatFields({
                Country: countryInfo.name,
                Language: countryInfo.language,
                CountryCode: countryInfo.code,
            });
            // Initialize
            embeddedservice_bootstrap.init(
                "00DMA000003XnGM",
                "LPM_Leapmotor",
                "https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231", {
                    scrt2URL: "https://leapmotor--dev01.sandbox.my.salesforce-scrt.com",
                }
            );
            // Initialize custom button AFTER Salesforce is ready
            window.dispatchEvent(new Event('salesforceReady'));
        } catch (err) {
            console.error("Error loading Embedded Messaging:", err);
        }
    }
    /* --- Helper Functions for Country Logic --- */
    function getCountryCodeFromPath() {
        const pathParts = window.location.pathname.split('/').filter(p => p.length > 0);
        return pathParts.length > 0 ? pathParts[0].toLowerCase() : 'en';
    }
    function getCountryInfo(countryCode) {
        const MAPPING = {
            'it': { name: 'Italy', language: 'it', code: 'it' },
            'es': { name: 'Spain', language: 'es', code: 'es' },
            'fr': { name: 'France', language: 'fr', code: 'fr' },
            'de': { name: 'Germany', language: 'de', code: 'de' },
            'uk': { name: 'United Kingdom', language: 'en_US', code: 'uk' },
            'us': { name: 'United States', language: 'en_US', code: 'us' },
            'en': { name: 'United States', language: 'en_US', code: 'en' }
        };
        return MAPPING[countryCode] || MAPPING['en'];
    }
    /**
     * Custom Chat Button Module
     * Implements PDF Design: Circular Button + Idle Proactive Message
     */
    (function() {
        'use strict';
        const CONFIG = {
            ids: {
                BUTTON: 'leap-chat-btn',
                BUBBLE: 'leap-chat-bubble',
                BADGE: 'leap-chat-badge',
                STYLES: 'leap-chat-css'
            },
            colors: {
                primary: '#009100',
                white: '#ffffff',
                text: '#333333'
            },
            timing: {
                idleThreshold: 5000
            }
        };
        const MESSAGES = {
            'es': '¿Necesitas ayuda?',
            'it': 'Hai bisogno di aiuto?',
            'fr': 'Besoin d\'aide ?',
            'de': 'Brauchen Sie Hilfe?',
            'en': 'Do you need help?'
        };
        let state = {
            idleTimer: null,
            countryCode: getCountryCodeFromPath(),
            esInstance: null,
            isReady: false
        };
        // --- Styles Injection ---
        function injectStyles() {
            if (document.getElementById(CONFIG.ids.STYLES)) return;
            const style = document.createElement('style');
            style.id = CONFIG.ids.STYLES;
            style.textContent = `
                #${CONFIG.ids.BUTTON} {
                    position: fixed;
                    right: 25px;
                    bottom: 25px;
                    width: 60px;
                    height: 60px;
                    border-radius: 50%;
                    background-color: ${CONFIG.colors.primary};
                    border: none;
                    cursor: pointer;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
                    z-index: 99999;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
                }
                #${CONFIG.ids.BUTTON}:hover {
                    transform: scale(1.1);
                }
                .leap-icon {
                    width: 32px;
                    height: 32px;
                    fill: ${CONFIG.colors.white};
                }
                
                #${CONFIG.ids.BUBBLE} {
                    position: fixed;
                    right: 95px;
                    bottom: 35px;
                    background: ${CONFIG.colors.white};
                    color: ${CONFIG.colors.text};
                    padding: 12px 20px;
                    border-radius: 20px 20px 0 20px;
                    box-shadow: 0 4px 15px rgba(0,0,0,0.15);
                    font-family: 'Montserrat', sans-serif;
                    font-weight: 600;
                    font-size: 14px;
                    opacity: 0;
                    transform: translateY(10px) scale(0.9);
                    transition: all 0.4s ease;
                    pointer-events: none;
                    z-index: 99998;
                    white-space: nowrap;
                }
                #${CONFIG.ids.BUBBLE}.visible {
                    opacity: 1;
                    transform: translateY(0) scale(1);
                    pointer-events: auto;
                }
                
                #${CONFIG.ids.BADGE} {
                    position: absolute;
                    top: -2px;
                    right: -2px;
                    background-color: #ff3b30;
                    color: white;
                    font-family: 'Montserrat', sans-serif;
                    font-size: 11px;
                    font-weight: bold;
                    width: 20px;
                    height: 20px;
                    border-radius: 50%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    border: 2px solid white;
                    display: none;
                }
            `;
            document.head.appendChild(style);
        }
        // --- Logic: Idle Timer ---
        function resetIdleTimer() {
            clearTimeout(state.idleTimer);
            state.idleTimer = setTimeout(() => {
                showProactiveMessage();
            }, CONFIG.timing.idleThreshold);
        }
        function showProactiveMessage() {
            const bubble = document.getElementById(CONFIG.ids.BUBBLE);
            const button = document.getElementById(CONFIG.ids.BUTTON);
            if (bubble && button && button.style.display !== 'none') {
                bubble.classList.add('visible');
            }
        }
        // --- DOM Elements ---
        function createElements() {
            const btn = document.createElement('button');
            btn.id = CONFIG.ids.BUTTON;
            btn.innerHTML = `
                <svg class="leap-icon" viewBox="0 0 24 24">
                   <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                </svg>
                <div id="${CONFIG.ids.BADGE}">1</div>
            `;
            
            const bubble = document.createElement('div');
            bubble.id = CONFIG.ids.BUBBLE;
            bubble.textContent = MESSAGES[state.countryCode] || MESSAGES['en'];
            
            document.body.appendChild(btn);
            document.body.appendChild(bubble);
            btn.onclick = function() {
                bubble.classList.remove('visible');
                launchChat();
            };
            
            document.addEventListener('mousemove', resetIdleTimer);
            document.addEventListener('keypress', resetIdleTimer);
            document.addEventListener('scroll', resetIdleTimer);
            resetIdleTimer();
        }
        // --- Launch Chat Function ---
        function launchChat() {
            if (!state.isReady) {
                console.warn('Embedded Messaging not ready yet');
                return;
            }
            try {
                // Try different methods to open the chat
                if (window.embeddedservice_bootstrap) {
                    if (window.embeddedservice_bootstrap.utilAPI && 
                        typeof window.embeddedservice_bootstrap.utilAPI.launchChat === 'function') {
                        window.embeddedservice_bootstrap.utilAPI.launchChat();
                    } else if (window.embeddedservice_bootstrap.maximizeWindow) {
                        window.embeddedservice_bootstrap.maximizeWindow();
                    } else {
                        console.error('No launch method available');
                    }
                }
            } catch (err) {
                console.error('Error launching chat:', err);
            }
        }
        // --- Salesforce Integration ---
        function hideStandardButton() {
            try {
                if (window.embeddedservice_bootstrap && 
                    window.embeddedservice_bootstrap.utilAPI && 
                    typeof window.embeddedservice_bootstrap.utilAPI.hideChatButton === 'function') {
                    window.embeddedservice_bootstrap.utilAPI.hideChatButton();
                }
            } catch (err) {
                console.error('Error hiding standard button:', err);
            }
        }
        function setupEventListeners() {
            window.addEventListener('onEmbeddedMessagingReady', () => {
                console.log('Embedded Messaging Ready');
                state.isReady = true;
                hideStandardButton();
            });
            window.addEventListener('onEmbeddedMessagingWindowMaximized', () => {
                const btn = document.getElementById(CONFIG.ids.BUTTON);
                const bubble = document.getElementById(CONFIG.ids.BUBBLE);
                if (btn) btn.style.display = 'none';
                if (bubble) bubble.classList.remove('visible');
            });
            window.addEventListener('onEmbeddedMessagingWindowMinimized', () => {
                const btn = document.getElementById(CONFIG.ids.BUTTON);
                if (btn) btn.style.display = 'flex';
            });
        }
        function init() {
            // Wait for Salesforce to be initialized
            window.addEventListener('salesforceReady', () => {
                setTimeout(() => {
                    injectStyles();
                    createElements();
                    setupEventListeners();
                    hideStandardButton();
                }, 500); // Small delay to ensure everything is loaded
            });
            // Fallback: Check periodically if salesforceReady event was missed
            let attempts = 0;
            const maxAttempts = 50;
            const checkInterval = setInterval(() => {
                attempts++;
                if (window.embeddedservice_bootstrap && window.embeddedservice_bootstrap.utilAPI) {
                    clearInterval(checkInterval);
                    if (!document.getElementById(CONFIG.ids.BUTTON)) {
                        injectStyles();
                        createElements();
                        setupEventListeners();
                        hideStandardButton();
                        state.isReady = true;
                    }
                } else if (attempts >= maxAttempts) {
                    clearInterval(checkInterval);
                    console.error('Embedded Messaging failed to load');
                }
            }, 200);
        }
        init();
    })();
</script>
<script type="text/javascript" 
    src="https://leapmotor--dev01.sandbox.my.site.com/ESWLPMLeapmotor1760706603231/assets/js/bootstrap.min.js" 
    onload="initEmbeddedMessaging()">
</script>
</body>
</html>
